(function(n){function A(aB){var aA={};for(var az=0;az<aB.length;az++){aA[aB[az]]=true}return aA}var an=A("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed".split(","));var B="div,p,address,applet,blockquote,button,center,dd,del,dir,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,,pre,script,table,tbody,td,tfoot,th,thead,tr,ul".split(",");var G=A(B);var at=A("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var".split(","));var F=A("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(","));var q=0,X=1,a=2,K=3;function E(az){n.extend(this,{ownerDocument:az,startContainer:az,endContainer:az,commonAncestorContainer:az,startOffset:0,endOffset:0,collapsed:true})}E.prototype={setStart:function(az,aA){this.startContainer=az;this.startOffset=aA;r(this);p(this,true)},setEnd:function(az,aA){this.endContainer=az;this.endOffset=aA;r(this);p(this,false)},setStartBefore:function(az){this.setStart(az.parentNode,l(az))},setStartAfter:function(az){this.setStart(az.parentNode,l(az)+1)},setEndBefore:function(az){this.setEnd(az.parentNode,l(az))},setEndAfter:function(az){this.setEnd(az.parentNode,l(az)+1)},selectNode:function(az){this.setStartBefore(az);this.setEndAfter(az)},selectNodeContents:function(az){this.setStart(az,0);this.setEnd(az,az[az.nodeType===1?"childNodes":"nodeValue"].length)},collapse:function(az){if(az){this.setEnd(this.startContainer,this.startOffset)}else{this.setStart(this.endContainer,this.endOffset)}},deleteContents:function(){var aA=this.cloneRange();if(this.startContainer!=this.commonAncestorContainer){this.setStartAfter(ah(this.commonAncestorContainer,this.startContainer))}this.collapse(true);(function az(aB){while(aB.next()){aB.hasPartialSubtree()?az(aB.getSubtreeIterator()):aB.remove()}})(new j(aA))},extractContents:function(){var aA=this.cloneRange();if(this.startContainer!=this.commonAncestorContainer){this.setStartAfter(ah(this.commonAncestorContainer,this.startContainer))}this.collapse(true);var aB=this;var az=m(this);return(function aC(aF){for(var aE,aD=az.createDocumentFragment();aE=aF.next();){aF.hasPartialSubtree()?aE=aE.cloneNode(false):aF.remove(aB.originalRange);if(aF.hasPartialSubtree()){aE.appendChild(aC(aF.getSubtreeIterator()))}aD.appendChild(aE)}return aD})(new j(aA))},insertNode:function(az){if(e(this.startContainer)){if(this.startOffset!=this.startContainer.nodeValue.length){ac(this.startContainer,this.startOffset)}y.insertAfter(az,this.startContainer)}else{y.insertAt(this.startContainer,az,this.startOffset)}this.setStart(this.startContainer,this.startOffset)},cloneRange:function(){return n.extend(new E(this.ownerDocument),{startContainer:this.startContainer,endContainer:this.endContainer,commonAncestorContainer:this.commonAncestorContainer,startOffset:this.startOffset,endOffset:this.endOffset,collapsed:this.collapsed,originalRange:this})},toString:function(){var aA=this.startContainer.nodeName,az=this.endContainer.nodeName;return[aA=="#text"?this.startContainer.nodeValue:aA,"(",this.startOffset,") : ",az=="#text"?this.endContainer.nodeValue:az,"(",this.endOffset,")"].join("")}};function k(aB,az,aG,aD){if(aB==az){return aD-aG}var aF=az;while(aF&&aF.parentNode!=aB){aF=aF.parentNode}if(aF){return l(aF)-aG}aF=aB;while(aF&&aF.parentNode!=az){aF=aF.parentNode}if(aF){return aD-l(aF)-1}var aE=y.commonAncestor(aB,az);var aC=aB;while(aC&&aC.parentNode!=aE){aC=aC.parentNode}if(!aC){aC=aE}var aA=az;while(aA&&aA.parentNode!=aE){aA=aA.parentNode}if(!aA){aA=aE}if(aC==aA){return 0}return l(aA)-l(aC)}function p(aA,aB){function az(aD){try{return k(aD.startContainer,aD.endContainer,aD.startOffset,aD.endOffset)<0}catch(aC){return true}}if(az(aA)){if(aB){aA.commonAncestorContainer=aA.endContainer=aA.startContainer;aA.endOffset=aA.startOffset}else{aA.commonAncestorContainer=aA.startContainer=aA.endContainer;aA.startOffset=aA.endOffset}aA.collapsed=true}}function r(aA){aA.collapsed=aA.startContainer==aA.endContainer&&aA.startOffset==aA.endOffset;var az=aA.startContainer;while(az&&az!=aA.endContainer&&!i(az,aA.endContainer)){az=az.parentNode}aA.commonAncestorContainer=az}function l(az){var aA=0;while(az=az.previousSibling){aA++}return aA}function e(az){return az&&az.nodeValue!==null&&az.data!==null}function i(az,aA){try{return !e(az)&&(n.contains(az,e(aA)?aA.parentNode:aA)||aA.parentNode==az)}catch(aB){return false}}function t(aA,az){return i(aA,az)||aA==az}function ah(aA,az){if(i(aA,az)){while(az&&az.parentNode!=aA){az=az.parentNode}}return az}function ak(az){return e(az)?az.length:az.childNodes.length}function ac(az,aB){var aA=az.cloneNode(false);az.deleteData(aB,az.length);aA.deleteData(0,aB);y.insertAfter(aA,az)}function aq(az){return az.createRange?az.createRange():new E(az)}function w(aA,aB){for(var aC in aB){var az=aA[aC];if(aC=="float"){az=aA[n.support.cssFloat?"cssFloat":"styleFloat"]}if(typeof az=="object"){if(!w(az,aB[aC])){return false}}else{if(az!=aB[aC]){return false}}}return true}function j(aA){n.extend(this,{range:aA,_current:null,_next:null,_end:null});if(aA.collapsed){return}var az=aA.commonAncestorContainer;this._next=aA.startContainer==az&&!e(aA.startContainer)?aA.startContainer.childNodes[aA.startOffset]:ah(az,aA.startContainer);this._end=aA.endContainer==az&&!e(aA.endContainer)?aA.endContainer.childNodes[aA.endOffset]:ah(az,aA.endContainer).nextSibling}j.prototype={hasNext:function(){return !!this._next},next:function(){var az=this._current=this._next;this._next=this._current&&this._current.nextSibling!=this._end?this._current.nextSibling:null;if(e(this._current)){if(this.range.endContainer==this._current){(az=az.cloneNode(true)).deleteData(this.range.endOffset,az.length-this.range.endOffset)}if(this.range.startContainer==this._current){(az=az.cloneNode(true)).deleteData(0,this.range.startOffset)}}return az},traverse:function(aA){function az(){this._current=this._next;this._next=this._current&&this._current.nextSibling!=this._end?this._current.nextSibling:null;return this._current}var aB;while(aB=az.call(this)){if(this.hasPartialSubtree()){this.getSubtreeIterator().traverse(aA)}else{aA(aB)}}return aB},remove:function(aE){var aD=this.range.startContainer==this._current;var aB=this.range.endContainer==this._current;if(e(this._current)&&(aD||aB)){var aA=aD?this.range.startOffset:0;var az=aB?this.range.endOffset:this._current.length;var aG=az-aA;if(aE&&(aD||aB)){if(this._current==aE.startContainer&&aA<=aE.startOffset){aE.startOffset-=aG}if(this._current==aE.endContainer&&az<=aE.endOffset){aE.endOffset-=aG}}this._current.deleteData(aA,aG)}else{var aF=this._current.parentNode;if(aE&&(this.range.startContainer==aF||this.range.endContainer==aF)){var aC=l(this._current);if(aF==aE.startContainer&&aC<=aE.startOffset){aE.startOffset-=1}if(aF==aE.endContainer&&aC<aE.endOffset){aE.endOffset-=1}}y.remove(this._current)}},hasPartialSubtree:function(){return !e(this._current)&&(t(this._current,this.range.startContainer)||t(this._current,this.range.endContainer))},getSubtreeIterator:function(){var az=this.range.cloneRange();az.selectNodeContents(this._current);if(t(this._current,this.range.startContainer)){az.setStart(this.range.startContainer,this.range.startOffset)}if(t(this._current,this.range.endContainer)){az.setEnd(this.range.endContainer,this.range.endOffset)}return new j(az)}};function ad(az){this.ownerDocument=az;this.rangeCount=1}ad.prototype={addRange:function(aA){var az=this.ownerDocument.body.createTextRange();f(az,aA,false);f(az,aA,true);az.select()},removeAllRanges:function(){this.ownerDocument.selection.empty()},getRangeAt:function(){var aB,aA=new E(this.ownerDocument),az=this.ownerDocument.selection;try{aB=az.createRange()}catch(aC){return aA}if(az.type=="Control"){aA.selectNode(aB.item(0))}else{am(aB,aA,true);am(aB,aA,false);if(aA.startContainer.nodeType==9){aA.setStart(aA.endContainer,aA.startOffset)}if(aA.endContainer.nodeType==9){aA.setEnd(aA.startContainer,aA.endOffset)}if(aB.compareEndPoints("StartToEnd",aB)==0){aA.collapse(false)}}return aA}};function f(aG,aA,az){var aD=aA[az?"startContainer":"endContainer"];var aE=aA[az?"startOffset":"endOffset"],aI=0;var aB=e(aD)?aD:aD.childNodes[aE]||null;var aF=e(aD)?aD.parentNode:aD;if(aD.nodeType==3||aD.nodeType==4){aI=aE}var aH=aF.insertBefore(y.create(aA.ownerDocument,"a"),aB);var aC=aA.ownerDocument.body.createTextRange();aC.moveToElementText(aH);y.remove(aH);aC[az?"moveStart":"moveEnd"]("character",aI);aC.collapse(false);aG.setEndPoint(az?"StartToStart":"EndToStart",aC)}function am(aE,aA,az){var aC=y.create(aA.ownerDocument,"a"),aF=aE.duplicate();aF.collapse(az);var aB=aF.parentElement();do{aB.insertBefore(aC,aC.previousSibling);aF.moveToElementText(aC)}while(aF.compareEndPoints(az?"StartToStart":"StartToEnd",aE)>0&&aC.previousSibling);aF.setEndPoint(az?"EndToStart":"EndToEnd",aE);var aD=aC.nextSibling;if(!aD){aD=aC.previousSibling;if(aD&&e(aD)){aA.setEnd(aD,aD.nodeValue.length);y.remove(aC)}else{aA.selectNodeContents(aB);y.remove(aC);aA.endOffset-=1}return}y.remove(aC);if(e(aD)){aA[az?"setStart":"setEnd"](aD,aF.text.length)}else{aA[az?"setStartBefore":"setEndBefore"](aD)}}var Z=n.telerik;function av(az){$editableArea=az.parent();var aD=$editableArea.outerHeight(true)-$editableArea.height();$editableArea.height($editableArea.parent().height()-$editableArea.prev().outerHeight(true)-aD);var aB=n("<iframe />",{src:'javascript:"<html></html>"',frameBorder:"0"}).css({width:"100%",height:"100%"}).insertBefore(az)[0];var aA=aB.contentWindow||aB;var aC=aA.document||aB.contentDocument;aC.designMode="On";aC.open();aC.write('<!DOCTYPE><html><head xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">html,body{padding:0px;margin:0;font:12px/1.4em Verdana,Geneva,sans-serif;background:#fff;}p{margin:.7em 0;}p:first-child{margin-top:0;}.t-marker{display:none;}a{color:#00a}</style></head><body spellcheck="false">'+az.val()+"</body></html>");aC.close();return aA}Z.editor=function(az,aA){if(/Mobile.*Safari/.test(navigator.userAgent)){return}var aB=this;this.element=az;var aC=n(az);if(aC.is("textarea")){Z.editor.extend(az)}aC.closest("form").bind("submit",function(){aB.update()});n.extend(this,aA);Z.bind(this,{load:this.onLoad,selectionChange:this.onSelectionChange,change:this.onChange,execute:this.onExecute});this.textarea=aC.find("textarea")[0];this.window=av(n(this.textarea));this.document=this.window.contentDocument||this.window.document;this.body=this.document.body;this.keyboard=new al([new ap(this),new u(this)]);this.pendingFormats=[];var aF=".t-editor-button .t-icon";this.undoRedoStack=new I();function aE(aG){return n.grep(aG.className.split(" "),function(aH){return !/^t-(icon|state-hover)$/i.test(aH)})[0].substring(2).toLowerCase()}function aD(aG){if(!aG.key){return aG.description}return new Z.stringBuilder().cat(aG.description).cat(" (").catIf("Ctrl + ",aG.ctrl).catIf("Shift + ",aG.shift).catIf("Alt + ",aG.alt).cat(aG.key).cat(")").string()}n(this.window).bind("blur",function(){var aG=aB.textarea.value;var aH=aB.encodedValue();aB.update(aH);if(aH!=aG){Z.trigger(aB.element,"change")}});aC.delegate(aF,"mouseenter",Z.hover).delegate(aF,"mouseleave",Z.leave).delegate(aF,"mousedown",Z.preventDefault).delegate(aF,"click",Z.stopAll(function(aG){aB.focus();aB.exec(aE(this))})).bind("selectionChange",function(){var aH=aB.getRange();var aG=h(aH);if(!aG.length){aG=[aH.startContainer]}aC.find(aF).each(function(){var aI=aB.tools[aE(this)];n(this).toggleClass("t-state-active",aI.finder().isFormatted(aG))})}).find(aF).each(function(){var aG=aB.tools[aE(this)];n(this).attr("unselectable","on").attr("title",aD(aG))});n(this.document).bind("contextmenu",Z.preventDefault).bind("keyup",function(aG){var aH=[8,9,13,33,34,35,36,37,38,39,40,40,45,46];if(n.inArray(aG.keyCode,aH)>-1){M(aB)}}).keydown(function(aH){var aG=aB.keyboard.toolFromShortcut(aB.tools,aH);if(aG){aH.preventDefault();aB.exec(aG);return false}aB.keyboard.clearTimeout();aB.keyboard.keydown(aH)}).keyup(function(aG){aB.keyboard.keyup(aG)}).mouseup(function(){M(aB)})};function M(az){Z.trigger(az.element,"selectionChange")}function m(aA){var az=aA.startContainer;return az.nodeType==9?az:az.ownerDocument}function z(az){return az.getSelection?az.getSelection():new ad(az.document)}function S(aA){var az=m(aA);return aw(az)}function aw(az){return z(ag(az))}function ag(az){return az.defaultView||az.parentWindow}function H(aA){var aB=L.image(aA);if(aB){aA.setStartAfter(aB);aA.setEndAfter(aB)}var az=S(aA);az.removeAllRanges();az.addRange(aA)}function ar(az){if(az.nodeType==1){az.normalize()}}function x(aD){var aC=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i;var az="xx-small,x-small,small,medium,large,x-large,xx-large".split(",");function aF(aI){var aJ=aC.exec(aI);if(!aJ){return aI}return"#"+n.map(aJ.slice(1),function(aK){return aK=parseInt(aK).toString(16),aK.length>1?aK:"0"+aK}).join("")}var aH=[];var aG={"telerik:script":{start:function(aI){aH.push("<script");aB(aI);aH.push(">")},end:function(){aH.push("</script>")}},b:{start:function(){aH.push("<strong>")},end:function(){aH.push("</strong>")}},i:{start:function(){aH.push("<em>")},end:function(){aH.push("</em>")}},u:{start:function(){aH.push('<span style="text-decoration:underline;">')},end:function(){aH.push("</span>")}},font:{start:function(aK){aH.push('<span style="');var aI=aK.getAttribute("color");var aJ=az[aK.getAttribute("size")];var aL=aK.getAttribute("face");if(aI){aH.push("color:");aH.push(aF(aI));aH.push(";")}if(aL){aH.push("font-face:");aH.push(aL);aH.push(";")}if(aJ){aH.push("font-size:");aH.push(aJ);aH.push(";")}aH.push('">')},end:function(aI){aH.push("</span>")}}};function aB(aQ){var aM=[];var aL=aQ.attributes;for(var aJ=0,aK=aL.length;aJ<aK;aJ++){var aO=aL[aJ];var aP=aO.nodeName;if(aO.specified||(aP=="value"&&aQ.value!="")||(aP=="type"&&aO.nodeValue=="text")){if(aP.indexOf("_moz")<0&&aP!="complete"){aM.push(aO)}}}if(!aM.length){return}aM.sort(function(aS,aT){return aS.nodeName>aT.nodeName?1:aS.nodeName<aT.nodeName?-1:0});for(var aJ=0,aK=aM.length;aJ<aK;aJ++){var aO=aM[aJ];var aI=aO.nodeName;var aR=aO.nodeValue;aH.push(" ");aH.push(aI);aH.push('="');if(aI=="style"){var aN=n.trim(aR||aQ.style.cssText);n.each(aN.split(";"),function(){if(this.length){var aU=this.split(":");var aT=n.trim(aU[0].toLowerCase()),aS=n.trim(aU[1]);if(aT.indexOf("color")>=0){aS=aF(aS)}aH.push(aT);aH.push(":");aH.push(aS);aH.push(";")}})}else{if(aI=="src"||aI=="href"){aH.push(aQ.getAttribute(aI,2))}else{aH.push(F[aI]?aI:aR)}}aH.push('"')}}function aA(aI,aJ){for(var aK=aI.firstChild;aK;aK=aK.nextSibling){aE(aK,aJ)}}function aE(aL,aM){var aO=aL.nodeType;if(aO==1){if(aL.attributes._moz_dirty&&y.is(aL,"br")){return}var aJ=y.name(aL);var aN=aG[aJ];if(aN){aN.start(aL);aA(aL);aN.end(aL);return}aH.push("<");aH.push(aJ);aB(aL);if(an[aJ]){aH.push(" />")}else{aH.push(">");aA(aL,aM||y.is(aL,"pre"));aH.push("</");aH.push(aJ);aH.push(">")}}else{if(aO==3){var aI=aL.nodeValue;if(!aM&&n.support.leadingWhitespace){var aK=aL.previousSibling;if(!aK||aK.innerHTML==""||y.isBlock(aK)){aI=aI.replace(/^[\r\n\v\f\t ]+/,"")}aI=aI.replace(/ +/," ")}aH.push(y.encode(aI))}else{if(aO==4){aH.push("<![CDATA[");aH.push(aL.data);aH.push("]]>")}else{if(aO==8){if(aL.data.indexOf("[CDATA[")<0){aH.push("<!--");aH.push(aL.data);aH.push("-->")}else{aH.push("<!");aH.push(aL.data);aH.push(">")}}}}}}aA(aD);return aH.join("")}function T(az,aA,aC){function aB(aF){var aD=az.cloneRange();aD.collapse(aF);aD[aF?"setStartBefore":"setEndAfter"](aA);var aE=aD.extractContents();if(aC){aE=y.trim(aE)}y[aF?"insertBefore":"insertAfter"](aE,aA)}aB(true);aB(false)}var ai=/^\s+$/;var y={blockParentOrBody:function(az){return y.parentOfType(az,B)||az.ownerDocument.body},encode:function(az){return az.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;")},name:function(az){return az.nodeName.toLowerCase()},significantChildNodes:function(az){return n.grep(az.childNodes,function(aA){return aA.nodeType!=3||!y.isWhitespace(aA)})},is:function(az,aA){return y.name(az)==aA},isMarker:function(az){return az.className=="t-marker"},isWhitespace:function(az){return ai.test(az.nodeValue)},isBlock:function(az){return G[y.name(az)]},isEmpty:function(az){return an[y.name(az)]},isInline:function(az){return at[y.name(az)]},scrollTo:function(az){az.ownerDocument.body.scrollTop=n(e(az)?az.parentNode:az).offset().top},insertAt:function(aA,az,aB){aA.insertBefore(az,aA.childNodes[aB]||null)},insertBefore:function(az,aA){return aA.parentNode.insertBefore(az,aA)},insertAfter:function(az,aA){return aA.parentNode.insertBefore(az,aA.nextSibling)},remove:function(az){az.parentNode.removeChild(az)},trim:function(aA){for(var az=aA.childNodes.length-1;az>=0;az--){var aB=aA.childNodes[az];if(e(aB)){if(aB.nodeValue.replace(/\ufeff/g,"").length==0){y.remove(aB)}}else{if(aB.className!="t-marker"){y.trim(aB);if(aB.childNodes.length==0){y.remove(aB)}}}}return aA},parentOfType:function(az,aA){do{az=az.parentNode}while(az&&!(y.ofType(az,aA)));return az},ofType:function(az,aA){return n.inArray(y.name(az),aA)>=0},changeTag:function(aD,aA){var aC=y.create(aD.ownerDocument,aA);var aG=aD.attributes;for(var aB=0;aB<aG.length;aB++){var aE=aG[aB];if(aE.specified){var aF=aE.nodeName;var az=aE.nodeValue;if(aF=="class"){aC.className=az}else{if(aF=="style"){aC.style.cssText=aD.style.cssText}else{aC.setAttribute(aF,az)}}}}while(aD.firstChild){aC.appendChild(aD.firstChild)}y.insertBefore(aC,aD);y.remove(aD);return aC},wrap:function(az,aA){y.insertBefore(aA,az);aA.appendChild(az);return aA},unwrap:function(az){var aA=az.parentNode;while(az.firstChild){aA.insertBefore(az.firstChild,az)}aA.removeChild(az)},create:function(aB,aA,az){return y.attr(aB.createElement(aA),az)},attr:function(az,aA){aA=n.extend({},aA);if(aA&&"style" in aA){y.style(az,aA.style);delete aA.style}return n.extend(az,aA)},style:function(az,aA){n(az).css(aA||{})},unstyle:function(aA,az){for(var aB in az){if(aB=="float"){aB=n.support.cssFloat?"cssFloat":"styleFloat"}aA.style[aB]=""}if(aA.style.cssText==""){aA.removeAttribute("style")}},commonAncestor:function(){var aC=arguments.length;if(!aC){return null}if(aC==1){return arguments[0]}var aD=[];var aE=Infinity;for(var az=0;az<aC;az++){var aG=[];var aH=arguments[az];while(aH){aG.push(aH);aH=aH.parentNode}aD.push(aG.reverse());aE=Math.min(aE,aG.length)}if(aC==1){return aD[0][0]}var aF=null;for(az=0;az<aE;az++){var aB=aD[0][az];for(var aA=1;aA<aC;aA++){if(aB!=aD[aA][az]){return aF}}aF=aB}return aF}};function R(az){this.enumerate=function(){var aB=[];function aA(aC){if(y.is(aC,"img")||(aC.nodeType==3&&!y.isWhitespace(aC))){aB.push(aC)}else{aC=aC.firstChild;while(aC){aA(aC);aC=aC.nextSibling}}}new j(az).traverse(aA);return aB}}function h(az){return new R(az).enumerate()}function aj(aA){var az=[];new j(aA).traverse(function(aB){if(aB.className=="t-marker"){az.push(aB)}});return az}function ab(){this.finder=new C();this.apply=function(az,aF){var aB=h(az);if(aF.innerHTML!=undefined){var aC=aj(az);var aA=m(az);az.deleteContents();var aD=y.create(aA,"a",aF);az.insertNode(aD);if(aC.length>1){y.insertAfter(aC[aC.length-1],aD);y.insertAfter(aC[1],aD);y[aB.length>0?"insertBefore":"insertAfter"](aC[0],aD)}}else{var aE=new b([{tags:["a"]}],aF);aE.finder=this.finder;aE.apply(aB)}}}function b(aB,aD){this.finder=new g(aB);var aC=n.extend({},aB[0].attr,aD);var az=aB[0].tags[0];function aA(aE){return y.wrap(aE,y.create(aE.ownerDocument,az,aC))}this.toggle=function(aG){var aH=h(aG);var aF=aH.length==0;var aJ;if(aF){var aI=aj(aG);aJ=aI[1];var aE=this.editor.document.createTextNode("\ufeff");y.insertBefore(aE,aJ);aH.push(aE);aE=aE.cloneNode(true);y.insertAfter(aE,aJ);aH.push(aE);aG.setEndAfter(aI[2])}if(this.finder.isFormatted(aH)){this.split(aG);this.remove(aH)}else{this.apply(aH)}if(aF){this.editor.pendingFormats.push(aJ.parentNode)}};this.apply=function(aH){var aG=[];for(var aE=0,aF=aH.length;aE<aF;aE++){var aJ=aH[aE];var aI=this.finder.findSuitable(aJ);if(aI){y.attr(aI,aC)}else{aI=aA(aJ)}aG.push(aI)}this.consolidate(aG)};this.remove=function(aH){for(var aE=0,aG=aH.length;aE<aG;aE++){var aF=this.finder.findFormat(aH[aE]);if(aF){y.unwrap(aF)}}};this.split=function(aH){var aI=h(aH);var aF=aI.length==0;var aJ;if(aF){aJ=aj(aH)[1];aI.push(aJ)}for(var aE=0,aG=aI.length;aE<aG;aE++){var aK=this.finder.findFormat(aI[aE]);if(aK){T(aH,aK,true)}}};this.consolidate=function(aG){while(aG.length>1){var aE=aG.pop();var aF=aG[aG.length-1];if(aE.previousSibling&&aE.previousSibling.className=="t-marker"){aF.appendChild(aE.previousSibling)}if(aE.previousSibling==aF){while(aE.firstChild){aF.appendChild(aE.firstChild)}y.remove(aE)}}}}function D(aB){var aD=new W(aB);function az(aG,aJ){var aF=y.create(aG.ownerDocument,"li");for(var aH=0;aH<aJ.length;aH++){var aI=aJ[aH];if(y.is(aI,"li")){aG.appendChild(aI);continue}aF.appendChild(aI);if(y.isBlock(aI)){aG.appendChild(aF);aF=aF.cloneNode(false)}}if(aF.childNodes.length){aG.appendChild(aF)}}function aE(aF,aH){for(var aG=0;aG<aH.length;aG++){if(t(aF,aH[aG])){return true}}return false}function aA(aG,aF){return aE(aG,aF)||y.isInline(aG)||aG.nodeType==3}this.split=function(aJ){var aK=h(aJ);if(aK.length){var aH=y.parentOfType(aK[0],["li"]);var aF=y.parentOfType(aK[aK.length-1],["li"]);aJ.setStartBefore(aH);aJ.setEndAfter(aF);for(var aG=0,aI=aK.length;aG<aI;aG++){var aL=aD.findFormat(aK[aG]);if(aL){T(aJ,aL,true)}}}};this.apply=function(aJ){var aI=aJ.length==1?aJ[0].ownerDocument.body:y.commonAncestor.apply(null,aJ);if(y.isInline(aI)){aI=y.blockParentOrBody(aI)}var aL=[];var aH=aD.findSuitable(aJ);if(!aH){aH=new W(aB=="ul"?"ol":"ul").findSuitable(aJ)}var aG=y.significantChildNodes(aI);for(var aF=0;aF<aG.length;aF++){var aK=aG[aF];var aM=y.name(aK);if(aA(aK,aJ)&&(!aH||!t(aH,aK))){if(aH&&(aM=="ul"||aM=="ol")){n.each(aK.childNodes,function(){aL.push(this)});y.remove(aK)}else{aL.push(aK)}}}if(aL.length==aG.length&&aI!=aJ[0].ownerDocument.body){aL=[aI]}if(!aH){aH=y.create(aI.ownerDocument,aB);y.insertBefore(aH,aL[0])}az(aH,aL);if(!y.is(aH,aB)){y.changeTag(aH,aB)}};function aC(aF){for(var aG=aF.firstChild;aG;aG=aG.nextSibling){var aI=y.create(aF.ownerDocument,"p");while(aG.firstChild){var aH=aG.firstChild;if(y.isBlock(aH)){y.insertBefore(aH,aF)}else{aI.appendChild(aH)}}if(aI.firstChild){y.insertBefore(aI,aF)}}y.remove(aF)}this.remove=function(aI){var aG;for(var aF=0,aH=aI.length;aF<aH;aF++){if(aG=aD.findFormat(aI[aF])){aC(aG)}}};this.toggle=function(aG){var aF=h(aG);if(!aF.length){aG.selectNodeContents(aG.commonAncestorContainer);aF=h(aG);if(!aF.length){aF=y.significantChildNodes(aG.commonAncestorContainer)}}if(aD.isFormatted(aF)){this.split(aG);this.remove(aF)}else{this.apply(aF)}}}function N(aA,aC){var aB=new s(aA);function az(aG,aK,aI){var aH=aI.length==1?y.blockParentOrBody(aI[0]):y.commonAncestor.apply(null,aI);if(y.isInline(aH)){aH=y.blockParentOrBody(aH)}var aJ=y.significantChildNodes(aH);var aF=l(aJ[0]);var aL=y.create(aH.ownerDocument,aG,aK);for(var aD=0;aD<aJ.length;aD++){var aE=aJ[aD];if(y.isBlock(aE)){y.attr(aE,aK);if(aL.childNodes.length){y.insertBefore(aL,aE);aL=aL.cloneNode(false)}aF=l(aE)+1;continue}aL.appendChild(aE)}if(aL.firstChild){y.insertAt(aH,aL,aF)}}this.apply=function(aH){var aF=y.is(aH[0],"img")?aH[0]:aB.findSuitable(aH);var aE=aF?J(y.name(aF),aA):aA[0];var aD=aE.tags[0];var aG=n.extend({},aE.attr,aC);if(aF){y.attr(aF,aG)}else{az(aD,aG,aH)}};this.remove=function(aG){for(var aD=0,aF=aG.length;aD<aF;aD++){var aE=aB.findFormat(aG[aD]);if(aE){if(y.ofType(aE,["p","img"])){y.unstyle(aE,J(y.name(aE),aA).attr.style)}else{y.unwrap(aE)}}}};this.toggle=function(aE){var aD=h(aE);if(!aD.length){aE.selectNodeContents(aE.commonAncestorContainer);aD=h(aE);if(!aD.length){aD=y.significantChildNodes(aE.commonAncestorContainer)}}if(aB.isFormatted(aD)){this.remove(aD)}else{this.apply(aD)}}}function W(az){s.call(this,[{tags:[az]}]);this.isFormatted=function(aD){var aA=[];for(var aC=0;aC<aD.length;aC++){var aB=this.findFormat(aD[aC]);if(aB&&n.inArray(aB,aA)<0){aA.push(aB)}}return aA.length==1};this.findSuitable=function(aA){return y.parentOfType(aA[0],[az])}}function s(aA){function az(aD,aE){for(var aB=0;aB<aE.length;aB++){var aC=aE[aB];if(aC==null||!t(aD,aC)){return false}}return true}this.findSuitable=function(aD){var aC=[];for(var aB=0;aB<aD.length;aB++){aC.push(y.parentOfType(aD[aB],aA[0].tags))}for(var aB=0;aB<aC.length;aB++){if(az(aC[aB],aC)){return aC[aB]}}return null};this.findFormat=function(aF){for(var aB=0;aB<aA.length;aB++){var aD=aF;var aC=aA[aB].tags;var aE=aA[aB].attr;while(aD){if(y.ofType(aD,aC)&&w(aD,aE)){return aD}aD=aD.parentNode}}return null},this.isFormatted=function(aB){for(var aC=0;aC<aB.length;aC++){if(!this.findFormat(aB[aC])){return false}}return true}}function C(){this.findSuitable=function(aA,az){return y.parentOfType(aA,["a"])}}function g(az){function aA(aD){var aB=0;for(var aC=aD.parentNode.firstChild;aC;aC=aC.nextSibling){if(aC!=aD&&aC.className!="t-marker"&&aC.nodeType==1){aB++}}return aB}this.findSuitable=function(aC,aB){if(!aB&&aA(aC)>0){return null}return y.parentOfType(aC,az[0].tags)};this.findFormat=function(aF){for(var aB=0;aB<az.length;aB++){var aD=aF;var aC=az[aB].tags;var aE=az[aB].attr;if(aD&&y.ofType(aD,aC)&&w(aD,aE)){return aD}while(aD){aD=y.parentOfType(aD,aC);if(aD&&w(aD,aE)){return aD}}}return null};this.isFormatted=function(aB){for(var aC=0;aC<aB.length;aC++){if(this.findFormat(aB[aC])){return true}}return false}}function U(aB){var aC=m(aB);this.body=aC.body;this.html=this.body.innerHTML;function aA(aD){var aE=[];while(aD!=aC){aE.push(l(aD));aD=aD.parentNode}return aE}function az(aF){var aE=aC,aD=aF.length;while(aD--){aE=aE.childNodes[aF[aD]]}return aE}this.startContainer=aA(aB.startContainer);this.endContainer=aA(aB.endContainer);this.startOffset=aB.startOffset;this.endOffset=aB.endOffset;this.toRange=function(){var aD=aB.cloneRange();aD.setStart(az(this.startContainer),this.startOffset);aD.setEnd(az(this.endContainer),this.endOffset);return aD}}function Y(aA){var aB=new U(aA);var az=new P();this.getRange=function(){return aB.toRange()};this.lockRange=function(aC){return az.add(this.getRange(),aC)};this.releaseRange=function(aC){az.remove(aC);H(aC)};this.undo=function(){aB.body.innerHTML=aB.html;H(aB.toRange())};this.redo=function(){this.exec()}}function c(az){Y.call(this,az.range);this.exec=function(){var aC=this.getRange();var aK=m(aC);var aI=n.browser.msie?"":'<br _moz_dirty="" />';var aL=y.parentOfType(aC.startContainer,["p"]),aA=y.parentOfType(aC.endContainer,["p"]),aB=(aL&&!aA)||(!aL&&aA);aC.deleteContents();var aJ=y.create(aK,"a");aC.insertNode(aJ);var aD=y.parentOfType(aJ,"li".split(","));var aE;if(aD){var aG=aC.cloneRange();aG.selectNode(aD);if(h(aG).length==0){var aM=y.create(aK,"p");if(aD.nextSibling){T(aG,aD.parentNode)}y.insertAfter(aM,aD.parentNode);y.remove(aD.parentNode.childNodes.length==1?aD.parentNode:aD);aM.innerHTML=aI;aE=aM}}if(!aE){if(!aD){new N([{tags:["p"]}]).apply([aJ])}aC.selectNode(aJ);var aF=y.parentOfType(aJ,[aD?"li":"p"]);T(aC,aF,aB);var aH=aF.previousSibling;if(y.is(aH,"li")&&aH.firstChild&&!y.is(aH.firstChild,"br")){aH=aH.firstChild}aE=aF.nextSibling;if(y.is(aE,"li")&&aE.firstChild&&!y.is(aE.firstChild,"br")){aE=aE.firstChild}y.remove(aF);if(aH.firstChild&&y.is(aH.firstChild,"br")){y.remove(aH.firstChild)}if(e(aH)&&aH.nodeValue==""){aH=aH.parentNode}if(aH&&aH.innerHTML==""){aH.innerHTML=aI}if(aE.firstChild&&y.is(aE.firstChild,"br")){y.remove(aE.firstChild)}if(e(aE)&&aE.nodeValue==""){aE=aE.parentNode}if(aE.innerHTML==""){aE.innerHTML=aI}ar(aH)}ar(aE);aC.selectNodeContents(aE);aC.collapse(true);y.scrollTo(aE);H(aC)}}function d(az){Y.call(this,az.range);this.exec=function(){var aB=this.getRange();aB.deleteContents();var aA=y.create(m(aB),"br");aB.insertNode(aA);aA.parentNode.normalize();if(!n.browser.msie&&(!aA.nextSibling||y.isWhitespace(aA.nextSibling))){var aC=aA.cloneNode(true);aC.setAttribute("_moz_dirty","");y.insertAfter(aC,aA)}aB.setStartAfter(aA);aB.collapse(true);H(aB)}}function af(aA){Y.call(this,aA.range);var az=new D(aA.tag);this.exec=function(){var aB=this.lockRange(true);az.toggle(aB);this.releaseRange(aB)}}function V(az){Y.call(this,az.range);this.exec=function(){var aB=this.lockRange(true);var aA=new b([{tags:["a"]}]);aA.remove(h(aB));this.releaseRange(aB)}}function ao(aA){Y.call(this,aA.range);this.async=true;var az;function aB(aC,aD){if(az.src&&az.src!="http://"){if(!aC){aC=y.create(m(aD),"img",az);aC.onload=aC.onerror=function(){aC.removeAttribute("complete");aC.removeAttribute("width");aC.removeAttribute("height")};aD.deleteContents();aD.insertNode(aC);aD.setStartAfter(aC);aD.setEndAfter(aC);H(aD);return true}else{y.attr(aC,az)}}return false}this.redo=function(){var aC=this.lockRange();if(!aB(L.image(aC),aC)){this.releaseRange(aC)}};this.exec=function(){var aF=this.lockRange();var aC=false;var aH=L.image(aF);function aI(aJ){az={src:n("#t-editor-image-url",aG.element).val(),alt:n("#t-editor-image-title",aG.element).val()};aC=aB(aH,aF);aE(aJ);if(aD.change){aD.change()}}var aD=this;function aE(aJ){aJ.preventDefault();aG.destroy();ag(m(aF)).focus();if(!aC){aD.releaseRange(aF)}}var aG=Z.window.create({title:"Insert image",html:new n.telerik.stringBuilder().cat('<div class="t-editor-dialog">').cat("<ol>").cat('<li class="t-form-text-row"><label for="t-editor-image-url">Web address</label><input type="text" id="t-editor-image-url"/></li>').cat('<li class="t-form-text-row"><label for="t-editor-image-title">Tooltip</label><input type="text" id="t-editor-image-title"/></li>').cat("</ol>").cat('<div class="t-button-wrapper">').cat('<button class="t-dialog-insert t-button t-state-default">Insert</button>').cat("&nbsp;or&nbsp;").cat('<a href="#" class="t-dialog-close">Close</a>').cat("</div>").cat("</div>").string(),modal:true,resizable:false,draggable:true,onClose:aE}).css("display","none").find(".t-dialog-insert").click(aI).end().find(".t-dialog-close").click(aE).end().find(".t-form-text-row input").keydown(function(aJ){if(aJ.keyCode==13){aI(aJ)}else{if(aJ.keyCode==27){aE(aJ)}}}).end().delegate(".t-button","mouseenter",Z.buttonHover).delegate(".t-button","mouseleave",Z.buttonLeave).find("#t-editor-image-url").val(aH?aH.getAttribute("src",2):"http://").end().find("#t-editor-image-title").val(aH?aH.alt:"").end().data("tWindow").open();n("#t-editor-image-url",aG.element).focus().select()}}function O(aA){Y.call(this,aA.range);var az;this.async=true;var aB=new ab();this.exec=function(){var aG=this.getRange();var aE=aG.collapsed;aG=this.lockRange(true);var aJ=h(aG);var aI=null;var aD=this;function aK(aQ){var aP=n("#t-editor-link-url",aH.element).val();if(aP&&aP!="http://"){az={href:aP};var aM=n("#t-editor-link-title",aH.element).val();if(aM){az.title=aM}var aN=n("#t-editor-link-text",aH.element).val();if(aN!==aI){az.innerHTML=aN}var aO=n("#t-editor-link-target",aH.element).val();if(aO!="false"){az.target="_blank"}aB.apply(aG,az)}aF(aQ);if(aD.change){aD.change()}}function aF(aM){aM.preventDefault();aH.destroy();ag(m(aG)).focus();aD.releaseRange(aG)}var aL=aJ.length?aB.finder.findSuitable(aJ[0]):null;var aC=aJ.length<=1||(aJ.length==2&&aE);var aH=Z.window.create({title:"Insert link",html:new n.telerik.stringBuilder().cat('<div class="t-editor-dialog">').cat("<ol>").cat('<li class="t-form-text-row"><label for="t-editor-link-url">Web address</label><input type="text" id="t-editor-link-url"/></li>').catIf('<li class="t-form-text-row"><label for="t-editor-link-text">Text</label><input type="text" id="t-editor-link-text"/></li>',aC).cat('<li class="t-form-text-row"><label for="t-editor-link-title">Tooltip</label><input type="text" id="t-editor-link-title"/></li>').cat('<li class="t-form-checkbox-row"><input type="checkbox" id="t-editor-link-target"/><label for="t-editor-link-target">Open link in new window</label></li>').cat("</ol>").cat('<div class="t-button-wrapper">').cat('<button class="t-dialog-insert t-button t-state-default">Insert</button>').cat("&nbsp;or&nbsp;").cat('<a href="#" class="t-dialog-close">Close</a>').cat("</div>").cat("</div>").string(),modal:true,resizable:false,draggable:true,onClose:aF}).css("display","none").find(".t-dialog-insert").click(aK).end().find(".t-dialog-close").click(aF).end().find(".t-form-text-row input").keydown(function(aM){if(aM.keyCode==13){aK(aM)}else{if(aM.keyCode==27){aF(aM)}}}).end().delegate(".t-button","mouseenter",Z.buttonHover).delegate(".t-button","mouseleave",Z.buttonLeave).find("#t-editor-link-url").val(aL?aL.getAttribute("href",2):"http://").end().find("#t-editor-link-text").val(aJ.length>0?(aJ.length==1?aJ[0].nodeValue:aJ[0].nodeValue+aJ[1].nodeValue):"").end().find("#t-editor-link-title").val(aL?aL.title:"").end().find("#t-editor-link-target").val(aL?aL.target=="_blank":"false").end().data("tWindow").open();if(aC&&aJ.length>0){aI=n("#t-editor-link-text",aH.element).val()}n("#t-editor-link-url",aH.element).focus().select()},this.redo=function(){var aC=this.lockRange(true);aB.apply(aC,az);this.releaseRange(aC)}}function Q(aA){Y.call(this,aA.range);var az=aA.formatter();this.exec=function(){var aB=this.lockRange(true);az.editor=this.editor;az.toggle(aB);this.releaseRange(aB)}}function au(aB,aA){var az=aB.body;this.redo=function(){az.innerHTML=aA.html;H(aA.toRange())};this.undo=function(){az.innerHTML=aB.html;H(aB.toRange())}}function I(){var aA=[],az=-1;this.push=function(aB){aA=aA.slice(0,az+1);az=aA.push(aB)-1};this.undo=function(){if(this.canUndo()){aA[az--].undo()}};this.redo=function(){if(this.canRedo()){aA[++az].redo()}};this.canUndo=function(){return az>=0};this.canRedo=function(){return az!=aA.length-1}}function ae(az){if(az.pendingFormats.length==0){return}az.pendingFormats.reverse();n.each(az.pendingFormats,function(){for(var aA=this.firstChild;aA;aA=aA.nextSibling){while(aA.nodeType==3&&(charIndex=aA.nodeValue.indexOf("\ufeff"))>=0){aA.deleteData(charIndex,1)}}});n.each(az.pendingFormats,function(){if(this.innerHTML==""&&this.parentNode){y.remove(this)}});az.pendingFormats=[]}function ap(az){this.keydown=function(aC){var aB=az.keyboard;var aA=aB.isTypingKey(aC);if(!aA){ae(az)}if(aA&&!aB.typingInProgress()){this.startRestorePoint=new U(az.getRange());aB.startTyping(n.proxy(function(){this.endRestorePoint=new U(az.getRange());az.undoRedoStack.push(new au(this.startRestorePoint,this.endRestorePoint))},this));return true}return false};this.keyup=function(aA){var aB=az.keyboard;if(aB.typingInProgress()){aB.endTyping();return true}return false}}function u(aA){var az=false;this.createUndoCommand=function(){this.endRestorePoint=new U(aA.getRange());aA.undoRedoStack.push(new au(this.startRestorePoint,this.endRestorePoint));this.startRestorePoint=this.endRestorePoint};this.changed=function(){if(this.startRestorePoint){return this.startRestorePoint.html!=aA.body.innerHTML}return false},this.keydown=function(aB){var aC=aA.keyboard;if(aC.isModifierKey(aB)){if(aC.typingInProgress()){aC.endTyping(true)}this.startRestorePoint=new U(aA.getRange());return true}if(aC.isSystem(aB)){az=true;if(this.changed()){az=false;this.createUndoCommand()}return true}return false};this.keyup=function(aB){if(az&&this.changed()){az=false;this.createUndoCommand(aB);return true}return false}}function al(aA){var aC=false;var aF;var aB;function az(aG){return(aG>=48&&aG<=90)||(aG>=96&&aG<=111)||(aG>=186&&aG<=192)||(aG>=219&&aG<=222)}this.toolFromShortcut=function(aI,aK){var aH=String.fromCharCode(aK.keyCode);for(var aJ in aI){var aG=aI[aJ];if((aG.key==aH||aG.key==aK.keyCode)&&!!aG.ctrl==aK.ctrlKey&&!!aG.alt==aK.altKey&&!!aG.shift==aK.shiftKey){return aJ}}};this.isTypingKey=function(aH){var aG=aH.keyCode;return(az(aG)&&!aH.ctrlKey&&!aH.altKey)||aG==32||aG==13||aG==8||(aG==46&&!aH.shiftKey&&!aH.ctrlKey&&!aH.altKey)};this.isModifierKey=function(aH){var aG=aH.keyCode;return(aG==17&&!aH.shiftKey&&!aH.altKey)||(aG==16&&!aH.ctrlKey&&!aH.altKey)||(aG==18&&!aH.ctrlKey&&!aH.shiftKey)};this.isSystem=function(aH){var aG=aH.keyCode;return(aH.ctrlKey||aH.altKey||aH.shiftKey)&&!(aG>=16&&aG<=18)&&aG!=90&&aG!=89};this.startTyping=function(aG){aB=aG;aC=true};function aD(){aC=false;aB()}this.endTyping=function(aG){this.clearTimeout();if(aG){aD()}else{aF=window.setTimeout(aD,1000)}};this.typingInProgress=function(){return aC};this.clearTimeout=function(){window.clearTimeout(aF)};function aE(aI,aH){for(var aG=0;aG<aA.length;aG++){if(aA[aG][aH](aI)){break}}}this.keydown=function(aG){aE(aG,"keydown")};this.keyup=function(aG){aE(aG,"keyup")}}function P(){var az;this.addCaret=function(aA){az=y.create(m(aA),"span",{className:"t-marker"});aA.insertNode(az);aA.selectNode(az)};this.removeCaret=function(aB){var aC=az.previousSibling;var aF=0;if(aC){aF=e(aC)?aC.nodeValue.length:l(aC)}var aE=az.parentNode;var aD=aC?l(aC):0;y.remove(az);ar(aE);var aA=aE.childNodes[aD];if(e(aA)){aB.setStart(aA,aF)}else{if(aA){aB[aC?"setStartAfter":"setStartBefore"](aA)}else{if(!n.browser.msie&&aE.innerHTML==""){aE.innerHTML='<br _moz_dirty="" />'}aB.selectNodeContents(aE)}}aB.collapse(true)};this.add=function(aA,aC){if(aC&&aA.collapsed){this.addCaret(aA);aA=L.expand(aA)}var aB=aA.cloneRange();aB.collapse(false);this.end=y.create(m(aA),"span",{className:"t-marker"});aB.insertNode(this.end);aB=aA.cloneRange();aB.collapse(true);this.start=this.end.cloneNode(true);aB.insertNode(this.start);aA.setStartBefore(this.start);aA.setEndAfter(this.end);ar(aA.commonAncestorContainer);return aA};this.remove=function(aH){var aA=this.start,aM=this.end;ar(aH.commonAncestorContainer);while(!aA.nextSibling&&aA.parentNode){aA=aA.parentNode}while(!aM.previousSibling&&aM.parentNode){aM=aM.parentNode}var aC=(aA.previousSibling&&aA.previousSibling.nodeType==3)&&(aA.nextSibling&&aA.nextSibling.nodeType==3);var aI=(aM.previousSibling&&aM.previousSibling.nodeType==3)&&(aM.nextSibling&&aM.nextSibling.nodeType==3);aA=aA.nextSibling;aM=aM.previousSibling;var aL=false;var aF=false;if(aA==this.end){aF=!!this.start.previousSibling;aA=aM=this.start.previousSibling||this.end.nextSibling;aL=true}y.remove(this.start);y.remove(this.end);var aK=aL?e(aA)?aA.nodeValue.length:aA.childNodes.length:0;var aD=e(aM)?aM.nodeValue.length:aM.childNodes.length;if(aA.nodeType==3){while(aA.previousSibling&&aA.previousSibling.nodeType==3){aA=aA.previousSibling;aK+=aA.nodeValue.length}}if(aM.nodeType==3){while(aM.previousSibling&&aM.previousSibling.nodeType==3){aM=aM.previousSibling;aD+=aM.nodeValue.length}}var aG=l(aA),aJ=aA.parentNode;var aE=l(aM),aB=aM.parentNode;for(var aO=aA;aO.previousSibling;aO=aO.previousSibling){if(aO.nodeType==3&&aO.previousSibling.nodeType==3){aG--}}for(var aN=aM;aN.previousSibling;aN=aN.previousSibling){if(aN.nodeType==3&&aN.previousSibling.nodeType==3){aE--}}ar(aJ);if(aA.nodeType==3){aA=aJ.childNodes[aG]}ar(aB);if(aM.nodeType==3){aM=aB.childNodes[aE]}if(aL){if(aA.nodeType==3){aH.setStart(aA,aK)}else{aH[aF?"setStartAfter":"setStartBefore"](aA)}aH.collapse(true)}else{if(aA.nodeType==3){aH.setStart(aA,aK)}else{aH.setStartBefore(aA)}if(aM.nodeType==3){aH.setEnd(aM,aD)}else{aH.setEndAfter(aM)}}if(az){this.removeCaret(aH)}}}var aa=/[\u0009-\u000d]|\u0020|\u00a0|\ufeff|\.|,|;|:|!|\(|\)|\?/;var L={image:function(aA){var az=[];new j(aA).traverse(function(aB){if(y.is(aB,"img")){az.push(aB)}});if(az.length==1){return az[0]}},expand:function(aA){var aB=aA.cloneRange();var aE=aB.startContainer.childNodes[aB.startOffset==0?0:aB.startOffset-1];var aF=aB.endContainer.childNodes[aB.endOffset];if(!e(aE)||!e(aF)){return aB}var aC=aE.nodeValue;var aD=aF.nodeValue;if(aC==""||aD==""){return aB}var az=aC.split("").reverse().join("").search(aa);var aG=aD.search(aa);if(az==0||aG==0){return aB}aG=aG==-1?aD.length:aG;az=az==-1?0:aC.length-az;aB.setStart(aE,az);aB.setEnd(aF,aG);return aB},isExpandable:function(aA){var aF=aA.startContainer;var aE=m(aA);if(aF==aE||aF==aE.body){return false}var aB=aA.cloneRange();var az=aF.nodeValue;if(!az){return false}var aC=az.substring(0,aB.startOffset);var aD=az.substring(aB.startOffset);var aG=0,aH=0;if(aC!=""){aG=aC.split("").reverse().join("").search(aa)}if(aD!=""){aH=aD.search(aa)}return aG!=0&&aH!=0}};n.extend(Z.editor,{Dom:y,Marker:P,RangeUtils:L,LinkFormatter:ab,InlineFormatter:b,ListFormatter:D,BlockFormatter:N,ListFormatFinder:W,BlockFormatFinder:s,LinkFormatFinder:C,InlineFormatFinder:g,RangeEnumerator:R,RestorePoint:U,ParagraphCommand:c,NewLineCommand:d,ListCommand:af,ImageCommand:ao,LinkCommand:O,UnlinkCommand:V,FormatCommand:Q,GenericCommand:au,UndoRedoStack:I,TypingHandler:ap,SystemHandler:u,Keyboard:al});Z.editor.prototype={value:function(az){if(az===undefined){return x(this.body)}az=az.replace(/<!\[CDATA\[(.*)?\]\]>/g,"<!--[CDATA[$1]]-->");az=az.replace(/<script([^>]*)>(.*)?<\/script>/ig,"<telerik:script $1>$2</telerik:script>");if(n.browser.msie){az="<br/>"+az;az=az.replace(/href\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/,'originalhref="$1"');az=az.replace(/src\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/,'originalsrc="$1"');this.body.innerHTML=az;y.remove(this.body.firstChild);n("script,link,img,a",this.body).each(function(){if(this["originalhref"]){this.setAttribute("href",this["originalhref"]);this.removeAttribute("originalhref")}if(this["originalsrc"]){this.setAttribute("src",this["originalsrc"]);this.removeAttribute("originalsrc")}})}else{this.body.innerHTML=az}this.update()},focus:function(){this.window.focus()},update:function(az){this.textarea.value=az||this.encodedValue()},encodedValue:function(){return y.encode(this.value())},createRange:function(az){return aq(az||this.document)},getSelection:function(){return aw(this.document)},selectRange:function(aA){var az=this.getSelection();az.removeAllRanges();az.addRange(aA)},getRange:function(){var az=this.getSelection();return az.rangeCount>0?az.getRangeAt(0):this.createRange()},exec:function(aD,aB){var aA=this.tools[aD.toLowerCase()];if(aA){var az=this.getRange();var aC=aA.command?aA.command({range:az}):null;Z.trigger(this.element,"execute",{name:aD,command:aC});if(/undo|redo/i.test(aD)){this.undoRedoStack[aD.toLowerCase()]()}else{this.undoRedoStack.push(aC);aC.editor=this;aC.exec();if(aC.async){aC.change=n.proxy(function(){M(this)},this);return}}M(this)}}};n.fn.tEditor=function(az){return Z.create(this,{name:"tEditor",init:function(aA,aB){return new Z.editor(aA,aB)},options:az})};var ay={bold:[{tags:["strong"]},{tags:["span"],attr:{style:{fontWeight:"bold"}}}],italic:[{tags:["em"]},{tags:["span"],attr:{style:{fontStyle:"italic"}}}],underline:[{tags:["span"],attr:{style:{textDecoration:"underline"}}}],strikeThrough:[{tags:["del"]},{tags:["span"],attr:{style:{textDecoration:"line-through"}}}],justifyLeft:[{tags:B,attr:{style:{textAlign:"left"}}},{tags:["img"],attr:{style:{"float":"left"}}}],justifyCenter:[{tags:B,attr:{style:{textAlign:"center"}}},{tags:["img"],attr:{style:{display:"block",marginLeft:"auto",marginRight:"auto"}}}],justifyRight:[{tags:B,attr:{style:{textAlign:"right"}}},{tags:["img"],attr:{style:{"float":"right"}}}],justifyFull:[{tags:B,attr:{style:{textAlign:"justify"}}}]};function ax(aA,az,aB){return n.extend(aA,{command:function(aC){return new Q(n.extend(aC,{format:az,formatter:function(){return new Z.editor[aB+"Formatter"](az)}}))},finder:function(){return new Z.editor[aB+"FormatFinder"](az)}})}function o(aA,az){return ax(n.extend(aA,{inline:true}),az,"Inline")}function v(aA,az){return ax(aA,az,"Block")}function J(aB,aA){for(var az=0;az<aA.length;az++){if(n.inArray(aB,aA[az].tags)>=0){return aA[az]}}}n.fn.tEditor.defaults={plugins:[],localization:{},formats:ay,tools:{bold:o({key:"B",ctrl:true,description:"Bold"},ay.bold),italic:o({key:"I",ctrl:true,description:"Italic"},ay.italic),underline:o({key:"U",ctrl:true,description:"Underline"},ay.underline),strikethrough:o({description:"Strikethrough"},ay.strikeThrough),undo:{key:"Z",ctrl:true},redo:{key:"Y",ctrl:true},newline:{key:13,shift:true,command:function(az){return new d(az)}},paragraph:{key:13,command:function(az){return new c(az)}},justifycenter:v({description:"Center text"},ay.justifyCenter),justifyleft:v({description:"Align text left"},ay.justifyLeft),justifyright:v({description:"Align text right"},ay.justifyRight),justifyfull:v({description:"Justify"},ay.justifyFull),insertunorderedlist:{description:"Insert unordered list",finder:function(){return new W("ul")},command:function(az){return new af(n.extend(az,{tag:"ul"}))}},insertorderedlist:{description:"Insert ordered list",finder:function(){return new W("ol")},command:function(az){return new af(n.extend(az,{tag:"ol"}))}},createlink:{key:"K",ctrl:true,description:"Insert hyperlink",finder:function(){return{isFormatted:function(){return false}}},command:function(az){return new O(az)}},unlink:{key:"K",ctrl:true,shift:true,description:"Remove hyperlink",finder:function(){return{isFormatted:function(){return false}}},command:function(az){return new V(az)}},insertimage:{description:"Insert image",finder:function(){return{isFormatted:function(){return false}}},command:function(az){return new ao(az)}}}}})(jQuery);